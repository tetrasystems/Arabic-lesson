<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arabic Grammar Mobile App - Lesson 13 Part 2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@11.0.5/dist/framer-motion.umd.js"></script>
    <style>
      [dir="rtl"] {
        direction: rtl;
        text-align: right;
      }
      html, body {
        overflow-x: hidden;
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-indigo-100 via-blue-100 to-purple-100 min-h-screen flex flex-col">
    <header class="sticky top-0 bg-white/80 backdrop-blur-lg border-b border-indigo-200 py-3 z-20">
      <h1 class="text-xl font-bold text-center text-indigo-900">
        Madina Arabic - Lesson 13 Part 2
      </h1>
      <p class="text-center text-gray-600 text-sm">Interactive Grammar Trainer</p>
    </header>

    <main id="app" class="flex-1 overflow-y-auto p-4 space-y-4"></main>

    <nav id="bottom-bar" class="sticky bottom-0 bg-white/90 backdrop-blur-md border-t border-gray-200 flex justify-around py-3">
      <button onclick="prevSentence()" id="prevBtn" class="disabled:opacity-40 text-indigo-700 font-semibold text-sm flex flex-col items-center">
        ⬅️<span>Prev</span>
      </button>
      <button onclick="toggleTransforms()" id="transBtn" class="text-blue-700 font-semibold text-sm flex flex-col items-center">
        🔄<span>Transform</span>
      </button>
      <button onclick="toggleAnalysis()" id="analysisBtn" class="text-purple-700 font-semibold text-sm flex flex-col items-center">
        📘<span>Analysis</span>
      </button>
      <button onclick="nextSentence()" id="nextBtn" class="text-indigo-700 font-semibold text-sm flex flex-col items-center">
        <span>Next</span>➡️
      </button>
    </nav>

    <script>
      const lesson = {
        sentences: [
          {
            arabic: "هَؤُلاَءِ مُسْلِمُونَ",
            transliteration: "haa'ulaa'i muslimūna",
            english: "These are Muslims (masculine)",
            analysis: {
              type: "Nominal Sentence",
              parts: ["هَؤُلاَءِ - Mubtada (Subject)", "مُسْلِمُونَ - Khabar (Predicate)"]
            },
            transforms: [
              "مُسْلِمٌ → مُسْلِمَةٌ (feminine)",
              "مُسْلِمٌ → مُسْلِمُونَ (masc. plural)",
              "مُسْلِمَةٌ → مُسْلِمَاتٌ (fem. plural)"
            ]
          },
          {
            arabic: "هَؤُلاَءِ مُسْلِمَاتٌ",
            transliteration: "haa'ulaa'i muslimātun",
            english: "These are Muslim women",
            analysis: {
              type: "Nominal Sentence",
              parts: ["هَؤُلاَءِ - Mubtada", "مُسْلِمَاتٌ - Khabar"]
            },
            transforms: [
              "مُسْلِمَةٌ → remove ة, add َاتٌ → مُسْلِمَاتٌ"
            ]
          }
        ]
      };

      let state = {
        index: 0,
        showAnalysis: false,
        showTransforms: false
      };

      function playAudio(text) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'ar-SA';
        utterance.rate = 0.65;
        speechSynthesis.speak(utterance);
      }

      function render() {
        const s = lesson.sentences[state.index];
        const app = document.getElementById('app');

        app.innerHTML = `
          <section class="bg-white rounded-2xl shadow-lg p-5 text-center space-y-3">
            <p class="text-4xl text-indigo-900 font-bold" dir="rtl">${s.arabic}</p>
            <button onclick="playAudio('${s.arabic}')" class="bg-green-600 text-white px-4 py-2 rounded-full text-sm">🔊 Listen</button>
            <p class="text-gray-700 italic text-sm">${s.transliteration}</p>
            <p class="text-lg font-semibold text-green-700">${s.english}</p>
          </section>

          ${state.showTransforms ? `
            <section class="bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-2">
              <h3 class="font-bold text-blue-800">Word Transformations:</h3>
              ${s.transforms.map(t => `<p dir="rtl">→ ${t}</p>`).join('')}
            </section>` : ''}

          ${state.showAnalysis ? `
            <section class="bg-purple-50 border border-purple-200 rounded-lg p-4 space-y-2">
              <h3 class="font-bold text-purple-800">Sentence Analysis:</h3>
              <p>${s.analysis.type}</p>
              ${s.analysis.parts.map(p => `<p>• ${p}</p>`).join('')}
            </section>` : ''}
        `;

        document.getElementById('prevBtn').disabled = state.index === 0;
        document.getElementById('nextBtn').disabled = state.index === lesson.sentences.length - 1;
      }

      function prevSentence() {
        if (state.index > 0) state.index--;
        render();
      }
      function nextSentence() {
        if (state.index < lesson.sentences.length - 1) state.index++;
        render();
      }
      function toggleAnalysis() {
        state.showAnalysis = !state.showAnalysis;
        render();
      }
      function toggleTransforms() {
        state.showTransforms = !state.showTransforms;
        render();
      }

      render();
    </script>
  </body>
</html>
