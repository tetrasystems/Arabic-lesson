<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Arabic Grammar Teacher - Lesson 13 Part A</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    [dir="rtl"] {
      direction: rtl;
      text-align: right;
    }
    
    /* Mobile optimizations */
    * {
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    /* Larger touch targets for mobile */
    button {
      min-height: 48px;
      touch-action: manipulation;
    }
    
    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }
    
    /* Prevent text size adjustment on orientation change */
    body {
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }
    
    /* Better spacing for mobile */
    @media (max-width: 640px) {
      .mobile-padding {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
      }
      
      .mobile-text {
        font-size: 1rem !important;
      }
      
      .mobile-title {
        font-size: 1.5rem !important;
      }
      
      .mobile-arabic {
        font-size: 2rem !important;
      }
      
      /* Make buttons easier to tap on mobile */
      button {
        min-height: 52px;
        font-size: 1.05rem;
        padding-top: 0.875rem;
        padding-bottom: 0.875rem;
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-100 via-blue-100 to-purple-100 min-h-screen">
  <div class="max-w-4xl mx-auto px-3 sm:px-6 py-4 sm:py-6">
    <div class="bg-white rounded-xl sm:rounded-2xl shadow-lg sm:shadow-2xl p-4 sm:p-8">
      <div class="mb-4 sm:mb-6 pb-3 sm:pb-4 border-b-2 border-gray-200">
        <h1 class="text-2xl sm:text-3xl font-bold text-center text-indigo-900">
          Madina Arabic - Lesson 13 Part A
        </h1>
        <p class="text-center text-gray-600 mt-2 text-sm sm:text-base">Pronouns & Demonstratives</p>
      </div>

      <div id="app"></div>
    </div>
  </div>

  <script>
    const lesson13a = {
      title: "Ø§Ù„Ø¯ÙÙ‘Ø±Ù’Ø³Ù Ø§Ù„Ø«ÙÙ‘Ø§Ù„ÙØ«Ù Ø¹ÙØ´ÙØ±Ù (Ø£) - Lesson 13 Part A",
      subtitle: "Pronouns & Demonstratives (Ø§Ù„Ø¶ÙÙ‘Ù…ÙØ§Ø¦ÙØ± ÙˆÙØ£ÙØ³Ù’Ù…ÙØ§Ø¡Ù Ø§Ù„Ø¥ÙØ´ÙØ§Ø±ÙØ©Ù)",

      sentences: [
        {
          arabic: "Ø£ÙÙ†ÙØ§ Ø·ÙØ§Ù„ÙØ¨ÙŒ",
          transliteration: "anÄ taalibun",
          english: "I am a student",
          transforms: {
            pronoun: "Ø£ÙÙ†ÙØ§ (anÄ) - I (1st person singular)",
            variants: [
              "Ø£ÙÙ†ÙØ§ - I (masculine/feminine - same form)",
              "Ù†ÙØ­Ù’Ù†Ù - We (1st person plural)"
            ],
            steps: [
              "Ø£ÙÙ†ÙØ§ is used for both masculine and feminine",
              "It's a separate/detached pronoun (Ø¶ÙÙ…ÙÙŠØ±ÙŒ Ù…ÙÙ†Ù’ÙÙØµÙÙ„)",
              "Always functions as mubtada in nominal sentences"
            ]
          },
          analysis: {
            type: "Ø¬ÙÙ…Ù’Ù„ÙØ©ÙŒ Ø¥ÙØ³Ù’Ù…ÙÙŠÙÙ‘Ø©ÙŒ (Nominal Sentence)",
            parts: [
              "Ø£ÙÙ†ÙØ§ - Mubtada (Subject) - Detached Pronoun (1st person)",
              "Ø·ÙØ§Ù„ÙØ¨ÙŒ - Khabar (Predicate) - Indefinite noun with tanween"
            ],
            rules: [
              "Detached pronouns can be mubtada",
              "First person pronoun: Ø£ÙÙ†ÙØ§ (I), Ù†ÙØ­Ù’Ù†Ù (we)",
              "Khabar must match mubtada in gender"
            ]
          }
        },
        {
          arabic: "Ø£ÙÙ†Ù’ØªÙ Ø·ÙØ¨ÙÙŠØ¨ÙŒ",
          transliteration: "anta tabÄ«bun",
          english: "You are a doctor (masculine)",
          transforms: {
            pronoun: "Ø£ÙÙ†Ù’ØªÙ (anta) - You (2nd person masc. sg)",
            fem: "Ø£ÙÙ†Ù’ØªÙ (anti) - You (2nd person fem. sg)",
            variants: [
              "Ø£ÙÙ†Ù’ØªÙ - You (masculine singular)",
              "Ø£ÙÙ†Ù’ØªÙ - You (feminine singular)",
              "Ø£ÙÙ†Ù’ØªÙÙ…ÙØ§ - You (dual - both genders)",
              "Ø£ÙÙ†Ù’ØªÙÙ…Ù’ - You (masculine plural)",
              "Ø£ÙÙ†Ù’ØªÙÙ†ÙÙ‘ - You (feminine plural)"
            ],
            steps: [
              "Ø£ÙÙ†Ù’ØªÙ (anta) for masculine",
              "Ø£ÙÙ†Ù’ØªÙ (anti) for feminine",
              "Used when addressing someone directly"
            ]
          },
          analysis: {
            type: "Ø¬ÙÙ…Ù’Ù„ÙØ©ÙŒ Ø¥ÙØ³Ù’Ù…ÙÙŠÙÙ‘Ø©ÙŒ (Nominal Sentence)",
            parts: [
              "Ø£ÙÙ†Ù’ØªÙ - Mubtada - 2nd person masculine singular pronoun",
              "Ø·ÙØ¨ÙÙŠØ¨ÙŒ - Khabar - Masculine noun (matches pronoun gender)"
            ],
            rules: [
              "Second person pronouns: Ø£ÙÙ†Ù’ØªÙ (you-masc), Ø£ÙÙ†Ù’ØªÙ (you-fem)",
              "Khabar must agree with pronoun in gender",
              "Used for addressing people"
            ]
          }
        },
        {
          arabic: "Ø£ÙÙ†Ù’ØªÙ Ø·ÙØ¨ÙÙŠØ¨ÙØ©ÙŒ",
          transliteration: "anti tabÄ«batun",
          english: "You are a doctor (feminine)",
          transforms: {
            masc: "Ø£ÙÙ†Ù’ØªÙ Ø·ÙØ¨ÙÙŠØ¨ÙŒ (you-masc are a doctor-masc)",
            fem: "Ø£ÙÙ†Ù’ØªÙ Ø·ÙØ¨ÙÙŠØ¨ÙØ©ÙŒ (you-fem are a doctor-fem)",
            steps: [
              "Ø£ÙÙ†Ù’ØªÙ (anta) â†’ Ø£ÙÙ†Ù’ØªÙ (anti) for feminine",
              "Ø·ÙØ¨ÙÙŠØ¨ÙŒ (masc) â†’ Ø·ÙØ¨ÙÙŠØ¨ÙØ©ÙŒ (fem) - add Ø©",
              "Both pronoun AND khabar must be feminine"
            ]
          },
          analysis: {
            type: "Ø¬ÙÙ…Ù’Ù„ÙØ©ÙŒ Ø¥ÙØ³Ù’Ù…ÙÙŠÙÙ‘Ø©ÙŒ (Nominal Sentence)",
            parts: [
              "Ø£ÙÙ†Ù’ØªÙ - Mubtada - 2nd person feminine singular pronoun",
              "Ø·ÙØ¨ÙÙŠØ¨ÙØ©ÙŒ - Khabar - Feminine noun (matches pronoun)"
            ],
            rules: [
              "Feminine 2nd person: Ø£ÙÙ†Ù’ØªÙ",
              "Gender agreement throughout the sentence",
              "Notice the kasra under the taa: Ø£ÙÙ†Ù’ØªÙ"
            ]
          }
        },
        {
          arabic: "Ù‡ÙÙˆÙ Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…ÙŒ",
          transliteration: "huwa mu'allimun",
          english: "He is a teacher",
          transforms: {
            masc: "Ù‡ÙÙˆÙ (huwa) - He (3rd person masc. sg)",
            fem: "Ù‡ÙÙŠÙ (hiya) - She (3rd person fem. sg)",
            variants: [
              "Ù‡ÙÙˆÙ - He (3rd person masculine singular)",
              "Ù‡ÙÙŠÙ - She (3rd person feminine singular)",
              "Ù‡ÙÙ…ÙØ§ - They (dual - both genders)",
              "Ù‡ÙÙ…Ù’ - They (masculine plural)",
              "Ù‡ÙÙ†ÙÙ‘ - They (feminine plural)"
            ],
            steps: [
              "Ù‡ÙÙˆÙ for masculine (he)",
              "Ù‡ÙÙŠÙ for feminine (she)",
              "Most commonly used pronouns in Arabic"
            ]
          },
          analysis: {
            type: "Ø¬ÙÙ…Ù’Ù„ÙØ©ÙŒ Ø¥ÙØ³Ù’Ù…ÙÙŠÙÙ‘Ø©ÙŒ (Nominal Sentence)",
            parts: [
              "Ù‡ÙÙˆÙ - Mubtada - 3rd person masculine pronoun (he)",
              "Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…ÙŒ - Khabar - Masculine noun"
            ],
            rules: [
              "Third person pronouns refer to someone absent",
              "Ù‡ÙÙˆÙ (he), Ù‡ÙÙŠÙ (she), Ù‡ÙÙ…Ù’ (they-masc), Ù‡ÙÙ†ÙÙ‘ (they-fem)",
              "Most frequently used in Arabic"
            ]
          }
        },
        {
          arabic: "Ù‡ÙÙŠÙ Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…ÙØ©ÙŒ",
          transliteration: "hiya mu'allimatun",
          english: "She is a teacher",
          transforms: {
            masc: "Ù‡ÙÙˆÙ Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…ÙŒ (he is a teacher-masc)",
            fem: "Ù‡ÙÙŠÙ Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…ÙØ©ÙŒ (she is a teacher-fem)",
            steps: [
              "Ù‡ÙÙˆÙ (huwa - he) â†’ Ù‡ÙÙŠÙ (hiya - she)",
              "Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…ÙŒ (masc) â†’ Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…ÙØ©ÙŒ (fem) - add Ø©",
              "Complete gender agreement required"
            ]
          },
          analysis: {
            type: "Ø¬ÙÙ…Ù’Ù„ÙØ©ÙŒ Ø¥ÙØ³Ù’Ù…ÙÙŠÙÙ‘Ø©ÙŒ (Nominal Sentence)",
            parts: [
              "Ù‡ÙÙŠÙ - Mubtada - 3rd person feminine pronoun (she)",
              "Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…ÙØ©ÙŒ - Khabar - Feminine noun with taa marbuta"
            ],
            rules: [
              "Feminine 3rd person: Ù‡ÙÙŠÙ",
              "Khabar takes feminine form",
              "Gender agreement is mandatory"
            ]
          }
        },
        {
          arabic: "Ù‡ÙÙ€Ù°Ø°ÙØ§ ÙƒÙØªÙØ§Ø¨ÙŒ Ø¬ÙØ¯ÙÙŠØ¯ÙŒ",
          transliteration: "haadhaa kitaabun jadÄ«dun",
          english: "This is a new book",
          transforms: {
            masc: "Ù‡ÙÙ€Ù°Ø°ÙØ§ (haadhaa) - This (masc. sg near)",
            fem: "Ù‡ÙÙ€Ù°Ø°ÙÙ‡Ù (haadhihi) - This (fem. sg near)",
            variants: [
              "Ù‡ÙÙ€Ù°Ø°ÙØ§ - This (masculine singular - near)",
              "Ù‡ÙÙ€Ù°Ø°ÙÙ‡Ù - This (feminine singular - near)",
              "Ù‡ÙÙ€Ù°Ø°ÙØ§Ù†Ù - These (masculine dual)",
              "Ù‡ÙÙ€Ù°ØªÙØ§Ù†Ù - These (feminine dual)",
              "Ù‡ÙØ¤ÙÙ„Ø§ÙØ¡Ù - These (plural - all genders)"
            ],
            steps: [
              "Ù‡ÙÙ€Ù°Ø°ÙØ§ for nearby masculine singular",
              "Ù‡ÙÙ€Ù°Ø°ÙÙ‡Ù for nearby feminine singular",
              "Used to point at things close to you"
            ]
          },
          analysis: {
            type: "Ø¬ÙÙ…Ù’Ù„ÙØ©ÙŒ Ø¥ÙØ³Ù’Ù…ÙÙŠÙÙ‘Ø©ÙŒ (Nominal Sentence)",
            parts: [
              "Ù‡ÙÙ€Ù°Ø°ÙØ§ - Mubtada - Near demonstrative (this - masc.)",
              "ÙƒÙØªÙØ§Ø¨ÙŒ - Khabar and Mawsoof - Indefinite masculine noun",
              "Ø¬ÙØ¯ÙÙŠØ¯ÙŒ - Sifa (Adjective) - Matches noun in gender and case"
            ],
            rules: [
              "Demonstrative pronouns can be mubtada",
              "Ù‡ÙÙ€Ù°Ø°ÙØ§ for near masculine, Ù‡ÙÙ€Ù°Ø°ÙÙ‡Ù for near feminine",
              "Adjective must match noun in definiteness, gender, and case"
            ]
          }
        },
        {
          arabic: "Ø°ÙÙ„ÙÙƒÙ Ø¨ÙÙŠÙ’ØªÙŒ ÙƒÙØ¨ÙÙŠØ±ÙŒ",
          transliteration: "dhaalika baytun kabÄ«run",
          english: "That is a big house",
          transforms: {
            masc: "Ø°ÙÙ„ÙÙƒÙ (dhaalika) - That (masc. sg far)",
            fem: "ØªÙÙ„Ù’ÙƒÙ (tilka) - That (fem. sg far)",
            variants: [
              "Ø°ÙÙ„ÙÙƒÙ - That (masculine singular - far)",
              "ØªÙÙ„Ù’ÙƒÙ - That (feminine singular - far)",
              "Ø°ÙØ§Ù†ÙÙƒÙ - Those (masculine dual)",
              "ØªÙØ§Ù†ÙÙƒÙ - Those (feminine dual)",
              "Ø£ÙÙˆÙ„ÙÙ€Ù°Ø¦ÙÙƒÙ - Those (plural - all genders)"
            ],
            steps: [
              "Ø°ÙÙ„ÙÙƒÙ for distant masculine singular",
              "ØªÙÙ„Ù’ÙƒÙ for distant feminine singular",
              "Used to point at things far from you"
            ]
          },
          analysis: {
            type: "Ø¬ÙÙ…Ù’Ù„ÙØ©ÙŒ Ø¥ÙØ³Ù’Ù…ÙÙŠÙÙ‘Ø©ÙŒ (Nominal Sentence)",
            parts: [
              "Ø°ÙÙ„ÙÙƒÙ - Mubtada - Far demonstrative (that - masc.)",
              "Ø¨ÙÙŠÙ’ØªÙŒ - Khabar and Mawsoof - Indefinite masculine noun",
              "ÙƒÙØ¨ÙÙŠØ±ÙŒ - Sifa (Adjective) - Matches noun"
            ],
            rules: [
              "Far demonstratives: Ø°ÙÙ„ÙÙƒÙ (masc), ØªÙÙ„Ù’ÙƒÙ (fem)",
              "Contrast with near: Ù‡ÙÙ€Ù°Ø°ÙØ§ (this-near) vs Ø°ÙÙ„ÙÙƒÙ (that-far)",
              "Adjective agreement is required"
            ]
          }
        }
      ],

      quiz: [
        {
          question: "Which pronoun means 'I' in Arabic?",
          options: [
            "Ø£ÙÙ†Ù’ØªÙ",
            "Ø£ÙÙ†ÙØ§",
            "Ù‡ÙÙˆÙ",
            "Ù†ÙØ­Ù’Ù†Ù"
          ],
          correct: 1,
          explanation: "Ø£ÙÙ†ÙØ§ (anÄ) means 'I' and is used for both masculine and feminine speakers."
        },
        {
          question: "What is the feminine form of Ø£ÙÙ†Ù’ØªÙ (you - masculine)?",
          options: [
            "Ø£ÙÙ†ÙØ§",
            "Ø£ÙÙ†Ù’ØªÙ",
            "Ù‡ÙÙŠÙ",
            "Ø£ÙÙ†Ù’ØªÙÙ…Ù’"
          ],
          correct: 1,
          explanation: "Ø£ÙÙ†Ù’ØªÙ (anti) is the feminine singular form of 'you'."
        },
        {
          question: "Which demonstrative pronoun means 'this' for masculine nouns?",
          options: [
            "Ù‡ÙÙ€Ù°Ø°ÙÙ‡Ù",
            "Ø°ÙÙ„ÙÙƒÙ",
            "Ù‡ÙÙ€Ù°Ø°ÙØ§",
            "ØªÙÙ„Ù’ÙƒÙ"
          ],
          correct: 2,
          explanation: "Ù‡ÙÙ€Ù°Ø°ÙØ§ (haadhaa) means 'this' for nearby masculine singular nouns."
        },
        {
          question: "What does Ù‡ÙÙˆÙ mean?",
          options: [
            "You (masculine)",
            "I",
            "He",
            "They"
          ],
          correct: 2,
          explanation: "Ù‡ÙÙˆÙ (huwa) is the third person masculine singular pronoun meaning 'he'."
        },
        {
          question: "Which demonstrative is used for things that are FAR away (masculine)?",
          options: [
            "Ù‡ÙÙ€Ù°Ø°ÙØ§",
            "Ø°ÙÙ„ÙÙƒÙ",
            "Ù‡ÙÙ€Ù°Ø°ÙÙ‡Ù",
            "Ù‡ÙØ¤ÙÙ„Ø§ÙØ¡Ù"
          ],
          correct: 1,
          explanation: "Ø°ÙÙ„ÙÙƒÙ (dhaalika) means 'that' for distant masculine singular nouns."
        },
        {
          question: "What is the feminine form of Ù‡ÙÙˆÙ (he)?",
          options: [
            "Ø£ÙÙ†Ù’ØªÙ",
            "Ù‡ÙÙŠÙ",
            "Ù‡ÙÙ…Ù’",
            "Ù†ÙØ­Ù’Ù†Ù"
          ],
          correct: 1,
          explanation: "Ù‡ÙÙŠÙ (hiya) is the third person feminine singular pronoun meaning 'she'."
        }
      ]
    };

    let state = {
      currentSection: 'intro',
      currentSentence: 0,
      showAnalysis: false,
      showTransforms: false,
      quizAnswers: {},
      showResults: false
    };

    function render() {
      const app = document.getElementById('app');
      
      if (state.currentSection === 'intro') {
        app.innerHTML = `
          <div class="space-y-4 sm:space-y-6">
            <div class="bg-gradient-to-r from-blue-100 to-indigo-100 p-4 sm:p-6 rounded-lg border-2 border-blue-300">
              <h2 class="text-xl sm:text-2xl font-bold text-indigo-900 mb-3" dir="rtl">${lesson13a.title}</h2>
              <p class="text-base sm:text-lg text-gray-700 mb-2" dir="rtl">${lesson13a.subtitle}</p>
            </div>

            <div class="bg-white p-4 sm:p-6 rounded-lg border-2 border-gray-200 shadow-sm">
              <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-3 sm:mb-4">ğŸ“š What You'll Learn:</h3>
              <ul class="space-y-2 sm:space-y-3">
                <li class="flex items-start">
                  <span class="text-green-600 mr-2 flex-shrink-0">âœ“</span>
                  <span>Personal Pronouns (Ø£ÙÙ†ÙØ§, Ø£ÙÙ†Ù’ØªÙ, Ø£ÙÙ†Ù’ØªÙ, Ù‡ÙÙˆÙ, Ù‡ÙÙŠÙ)</span>
                </li>
                <li class="flex items-start">
                  <span class="text-green-600 mr-2 flex-shrink-0">âœ“</span>
                  <span>Near Demonstratives (Ù‡ÙÙ€Ù°Ø°ÙØ§, Ù‡ÙÙ€Ù°Ø°ÙÙ‡Ù)</span>
                </li>
                <li class="flex items-start">
                  <span class="text-green-600 mr-2 flex-shrink-0">âœ“</span>
                  <span>Far Demonstratives (Ø°ÙÙ„ÙÙƒÙ, ØªÙÙ„Ù’ÙƒÙ)</span>
                </li>
                <li class="flex items-start">
                  <span class="text-green-600 mr-2 flex-shrink-0">âœ“</span>
                  <span>Gender agreement in sentences</span>
                </li>
                <li class="flex items-start">
                  <span class="text-green-600 mr-2 flex-shrink-0">âœ“</span>
                  <span>How to use pronouns as sentence subjects</span>
                </li>
                <li class="flex items-start">
                  <span class="text-green-600 mr-2 flex-shrink-0">âœ“</span>
                  <span>Demonstrative pronouns for pointing</span>
                </li>
              </ul>
            </div>

            <button onclick="changeSection('lesson')" class="w-full bg-indigo-600 text-white py-4 px-6 rounded-lg font-bold text-lg hover:bg-indigo-700">
              Start Lesson â†’
            </button>
          </div>
        `;
      } else if (state.currentSection === 'lesson') {
        const sentence = lesson13a.sentences[state.currentSentence];
        
        app.innerHTML = `
          <div class="space-y-4 sm:space-y-6">
            <div class="flex items-center justify-between mb-3 sm:mb-4">
              <span class="text-xs sm:text-sm text-gray-600 font-semibold">
                Sentence ${state.currentSentence + 1} of ${lesson13a.sentences.length}
              </span>
              <div class="bg-gray-200 rounded-full h-2 w-32 sm:w-48">
                <div class="bg-indigo-600 h-2 rounded-full transition-all" style="width: ${((state.currentSentence + 1) / lesson13a.sentences.length) * 100}%"></div>
              </div>
            </div>

            <div class="bg-gradient-to-r from-indigo-50 to-blue-50 p-4 sm:p-6 rounded-lg border-2 border-indigo-200">
              <div class="text-center space-y-3 sm:space-y-4">
                <p class="text-3xl sm:text-4xl md:text-5xl font-bold text-indigo-900" dir="rtl">
                  ${sentence.arabic}
                </p>
                <p class="text-base sm:text-lg text-gray-600 italic">
                  ${sentence.transliteration}
                </p>
                <p class="text-lg sm:text-xl text-gray-800 font-semibold">
                  ${sentence.english}
                </p>
              </div>
            </div>

            <div class="flex flex-col sm:flex-row gap-3">
              <button onclick="toggleTransforms()" class="flex-1 bg-indigo-600 text-white py-3 px-4 rounded-lg font-bold hover:bg-indigo-700">
                ${state.showTransforms ? 'Hide' : 'Show'} Transformations
              </button>
              <button onclick="toggleAnalysis()" class="flex-1 bg-purple-600 text-white py-3 px-4 rounded-lg font-bold hover:bg-purple-700">
                ${state.showAnalysis ? 'Hide' : 'Show'} Analysis
              </button>
            </div>

            ${state.showTransforms ? `
              <div class="bg-blue-50 p-4 sm:p-6 rounded-lg border-2 border-blue-200 mb-4">
                <h3 class="font-bold text-blue-900 mb-3 text-xl">Pronoun Forms & Transformations:</h3>
                <div class="space-y-3">
                  ${Object.entries(sentence.transforms).map(([key, value]) => {
                    if (key === 'variants' && Array.isArray(value)) {
                      return `<div class="bg-white p-4 rounded-lg">
                        <p class="font-bold text-blue-800 mb-2">All Forms:</p>
                        ${value.map(v => `<p class="text-gray-700 mb-1" dir="rtl">â€¢ ${v}</p>`).join('')}
                      </div>`;
                    }
                    if (key === 'steps' && Array.isArray(value)) {
                      return `<div class="bg-white p-4 rounded-lg">
                        <p class="font-bold text-blue-800 mb-2">Step-by-Step:</p>
                        ${value.map(step => `<p class="text-gray-700 mb-1" dir="rtl">â†’ ${step}</p>`).join('')}
                      </div>`;
                    }
                    if (typeof value === 'string') {
                      return `<div class="bg-white p-3 rounded">
                        <p class="text-sm font-semibold text-blue-700">${key}:</p>
                        <p class="text-lg" dir="rtl">${value}</p>
                      </div>`;
                    }
                    return '';
                  }).join('')}
                </div>
              </div>
            ` : ''}

            ${state.showAnalysis ? `
              <div class="bg-purple-50 p-4 sm:p-6 rounded-lg border-2 border-purple-200 space-y-4">
                <div class="bg-white p-4 rounded-lg">
                  <h3 class="font-bold text-purple-900 mb-2">Sentence Type:</h3>
                  <p class="text-gray-700" dir="rtl">${sentence.analysis.type}</p>
                </div>

                <div class="bg-white p-4 rounded-lg">
                  <h3 class="font-bold text-purple-900 mb-3">Components:</h3>
                  ${sentence.analysis.parts.map(part => `<p class="text-gray-700 mb-2">â€¢ ${part}</p>`).join('')}
                </div>

                <div class="bg-white p-4 rounded-lg">
                  <h3 class="font-bold text-purple-900 mb-2">Grammar Rules:</h3>
                  <ul class="space-y-2">
                    ${sentence.analysis.rules.map(rule => `
                      <li class="flex items-start">
                        <span class="text-purple-600 mr-2">âœ“</span>
                        <span class="text-gray-700">${rule}</span>
                      </li>
                    `).join('')}
                  </ul>
                </div>
              </div>
            ` : ''}

            <div class="flex flex-col sm:flex-row justify-between gap-3 pt-4">
              <button onclick="prevSentence()" ${state.currentSentence === 0 ? 'disabled' : ''} 
                class="w-full sm:w-auto bg-gray-300 text-gray-700 py-2 px-6 rounded-lg font-bold hover:bg-gray-400 disabled:opacity-50">
                â† Previous
              </button>
              
              ${state.currentSentence < lesson13a.sentences.length - 1 ? `
                <button onclick="nextSentence()" class="w-full sm:w-auto bg-indigo-600 text-white py-2 px-6 rounded-lg font-bold hover:bg-indigo-700">
                  Next â†’
                </button>
              ` : `
                <button onclick="changeSection('quiz')" class="w-full sm:w-auto bg-green-600 text-white py-2 px-6 rounded-lg font-bold hover:bg-green-700">
                  Quiz ğŸ†
                </button>
              `}
            </div>
          </div>
        `;
      } else if (state.currentSection === 'quiz') {
        const score = Object.entries(state.quizAnswers).filter(([qIdx, answer]) => 
          answer === lesson13a.quiz[qIdx].correct
        ).length;

        app.innerHTML = `
          <div class="space-y-4 sm:space-y-6">
            <div class="bg-white p-6 rounded-lg border-2 border-orange-200 shadow-lg">
              <h2 class="text-2xl font-bold text-orange-900 mb-4">ğŸ† Lesson 13 Part A Quiz</h2>

              ${lesson13a.quiz.map((q, qIdx) => `
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                  <p class="font-semibold text-gray-800 mb-3">
                    ${qIdx + 1}. ${q.question}
                  </p>
                  <div class="space-y-2">
                    ${q.options.map((option, oIdx) => `
                      <button onclick="answerQuestion(${qIdx}, ${oIdx})" 
                        ${state.showResults ? 'disabled' : ''}
                        class="w-full text-left p-3 rounded-lg border-2 transition-all ${
                          state.showResults
                            ? oIdx === q.correct
                              ? 'bg-green-100 border-green-500'
                              : state.quizAnswers[qIdx] === oIdx
                              ? 'bg-red-100 border-red-500'
                              : 'bg-white border-gray-200'
                            : state.quizAnswers[qIdx] === oIdx
                            ? 'bg-blue-100 border-blue-500'
                            : 'bg-white border-gray-200 hover:bg-gray-100'
                        }">
                        ${state.showResults && oIdx === q.correct ? 'âœ“ ' : ''}
                        ${state.showResults && state.quizAnswers[qIdx] === oIdx && oIdx !== q.correct ? 'âœ— ' : ''}
                        ${option}
                      </button>
                    `).join('')}
                  </div>
                  ${state.showResults ? `
                    <div class="mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200">
                      <p class="text-sm text-blue-900">
                        <strong>Explanation:</strong> ${q.explanation}
                      </p>
                    </div>
                  ` : ''}
                </div>
              `).join('')}

              ${!state.showResults ? `
                <button onclick="submitQuiz()" 
                  ${Object.keys(state.quizAnswers).length < lesson13a.quiz.length ? 'disabled' : ''} 
                  class="w-full bg-orange-600 text-white py-3 px-6 rounded-lg font-bold hover:bg-orange-700 disabled:opacity-50">
                  Submit Quiz
                </button>
              ` : `
                <div class="text-center">
                  <div class="bg-gradient-to-r from-green-100 to-blue-100 p-6 rounded-lg border-2 border-green-300 mb-4">
                    <h3 class="text-2xl font-bold text-green-900 mb-2">
                      Score: ${score} / ${lesson13a.quiz.length}
                    </h3>
                    <p class="text-lg text-gray-700">
                      ${score === lesson13a.quiz.length ? 'ğŸ‰ Perfect!' : score >= 4 ? 'ğŸ‘ Great!' : 'ğŸ“š Keep practicing!'}
                    </p>
                  </div>
                  <button onclick="resetLesson()" class="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg font-bold hover:bg-indigo-700">
                    Review Lesson
                  </button>
                </div>
              `}
            </div>
          </div>
        `;
      }
    }

    function changeSection(section) {
      state.currentSection = section;
      render();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function nextSentence() {
      if (state.currentSentence < lesson13a.sentences.length - 1) {
        state.currentSentence++;
        state.showAnalysis = false;
        state.showTransforms = false;
        render();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }

    function prevSentence() {
      if (state.currentSentence > 0) {
        state.currentSentence--;
        state.showAnalysis = false;
        state.showTransforms = false;
        render();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }

    function toggleAnalysis() {
      state.showAnalysis = !state.showAnalysis;
      render();
    }

    function toggleTransforms() {
      state.showTransforms = !state.showTransforms;
      render();
    }

    function answerQuestion(qIdx, oIdx) {
      if (!state.showResults) {
        state.quizAnswers[qIdx] = oIdx;
        render();
      }
    }

    function submitQuiz() {
      state.showResults = true;
      render();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function resetLesson() {
      state = {
        currentSection: 'intro',
        currentSentence: 0,
        showAnalysis: false,
        showTransforms: false,
        quizAnswers: {},
        showResults: false
      };
      render();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Initial render
    render();
  </script>
</body>
</html>
